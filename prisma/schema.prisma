generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

//Модели
//Пользователи системы
model User {
  id       String @id @default(uuid())
  name     String @unique
  password String
}

//Журнал записей
model Journal {
  id             String    @id @default(uuid())
  client         Client?   @relation(fields: [clientName, clientTelegram, clientPhone], references: [name, telegram, phone])
  clientName     String
  clientTelegram String?
  clientPhone    Int?
  barber         Barber    @relation(fields: [barberId], references: [id])
  barberId       String
  service        Service[]
  time           DateTime
  createdAt      DateTime  @default(now())
}

//Клиенты
model Client {
  id       String    @id @default(uuid())
  name     String
  telegram String?   @unique
  phone    Int?      @unique
  journal  Journal[]
  reviews  Review[]

  @@unique([name, telegram, phone])
  @@unique([name])
}

//Услуги
model Service {
  id      String    @id @default(uuid())
  service String
  price   Float
  journal Journal[]
}

//Барберы
model Barber {
  id      String    @id @default(uuid())
  name    String
  text    String
  rating  Int
  journal Journal[]
  reviews Review[]

  @@unique([name])
}

//Отзывы
model Review {
  id         String @id @default(uuid())
  client     Client @relation(fields: [clientName], references: [name])
  clientName String
  rating     Int    @default(5)
  text       String
  barber     Barber @relation(fields: [barberName], references: [name])
  barberName String
}
